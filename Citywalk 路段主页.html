
                <!DOCTYPE html>
                <html lang="zh">
                <head>
                  <meta charset="UTF-8">
                  <meta name="viewport" content="width=device-width, initial-scale=1.0">
                  <title>Citywalk 路段主页</title>
                  <style>
                    *,
                    *::before,
                    *::after {
                      box-sizing: border-box;
                      margin: 0;
                    }
                    .iframe-outer {
                      position: fixed;
                      top: 0;
                      left: 0;
                      bottom: 0;
                      right: 0;
                      display: flex;
                      justify-content: center;
                      background-color: #E0E0E0;
                    }
                    .iframe-wrapper {
                      width: 100%;
                      height: 100%;
                      margin: 0 auto;
                      transform-origin: center top;
                      flex-shrink: 0;
                    }
                    #dynamicIframe {
                      border: none;
                      width: 100%;
                      height: 100%;
                    }
                  </style>
                  <script>
                const width = 402
                const height = 874
                const resolutionRatio = width && height ? width / height : 1
                const pageNameMap = {
                  'splash_page': '启动页',
    'invitation_code_entry': '邀请码输入',
    'invitation_code_info': '邀请码获取说明',
    'citywalk_main': 'Citywalk 路段主页',
    'content_gacha_trigger': '内容抽卡触发页',
    'content_detail': '内容详情与回复',
    'content_upload': '内容上传页',
    'user_profile': '个人中心',
    'my_cards': '我的卡册',
    'gift_exchange': '礼品兑换',
    'points_history': '积分历史',
    'citywalk_info_guide': 'Citywalk 信息与指南',
    'support_feedback': '帮助与反馈'
                }
                function setIframeSize(w, h) {
                  const currentContainerRadio = w / h
                  let widthValue = w
                  let heightValue = h
                  let zoom = 1
                  if (currentContainerRadio > resolutionRatio) {
                    widthValue = h * resolutionRatio
                    heightValue = h
                  } else {
                    widthValue = w
                    heightValue = w / resolutionRatio
                  }
                  zoom = width ? widthValue / width : 1
                  return {
                    width: widthValue / zoom + 'px',
                    height: heightValue / zoom + 'px',
                    zoom,
                  }
                }
                function adjustIframeSize() {
                  const iframeWrapper = document.querySelector(".iframe-wrapper")
                  const { width, height, zoom } = setIframeSize(window.innerWidth, window.innerHeight)
                  iframeWrapper.style.height = height
                  iframeWrapper.style.width = width
                  iframeWrapper.style.transform = 'scale(' + zoom + ')'
                }
                function sanitizeFilename(name) {
                  return name.replace(/[\/:*?"<>|]/g, '_')
                }
                function handlePostMessage(event) {
                  if (!event.data) {
                    return
                  }
                  const { type, targetPageId } = event.data
                  const targetPageName = pageNameMap[targetPageId]
                  if (type === "iframeNavigation" && targetPageId && targetPageName) {
                    window.location.href = targetPageName + '.html'
                  }
                }
                window.addEventListener('message', handlePostMessage)
                window.onload = adjustIframeSize
                window.onresize = adjustIframeSize
                window.onunload = () => {
                  window.removeEventListener('message', handlePostMessage)
                }
              </script>
                </head>
                <body>
                  <div class="iframe-outer">
                    <div class="iframe-wrapper">
                      <iframe id="dynamicIframe" srcdoc='<html lang="zh" data-theme="business"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Citywalk 路线</title>
    <link href="./assets/static/uxbot/daisyui@5.css" rel="stylesheet" type="text/css">
    <script src="./assets/static/uxbot/tailwind-browser@4.js"></script>
    <link href="./assets/static/uxbot/daisyui-themes.css" rel="stylesheet" type="text/css">
    <script src="./assets/3/3.1.1/iconify.min.js"></script>
    <style>
/* CSS code for common usage */
/* daisyUI Theme Variables Customization
 * Based on the business theme and UI guidance requirements,
 * customize only the CSS variables that need to be different from the theme defaults.
 * Available theme variables for customization:
 */

/* Only modify if different from chosen theme defaults */
:root {
  /* Business theme with deep grey base and light accents */
  --color-primary: rgba(59, 130, 246, 0.8); /* Slightly desaturated blue */
  --color-primary-content: rgba(255, 255, 255, 1); /* White text on primary */
  --color-secondary: rgba(79, 70, 229, 0.8); /* Desaturated indigo */
  --color-secondary-content: rgba(255, 255, 255, 1);
  --color-accent: rgba(59, 130, 246, 0.8); /* Same as primary for consistency */
  --color-accent-content: rgba(255, 255, 255, 1);

  /* Deep grey backgrounds following Material Design Dark Theme */
  --color-base-100: rgba(33, 37, 41, 1); /* #212529 deep charcoal for cards */
  --color-base-200: rgba(26, 29, 33, 1); /* #1A1D21 darker for main content */
  --color-base-300: rgba(55, 65, 81, 1); /* #374151 lighter grey for borders */
  --color-base-content: rgba(248, 250, 252, 1); /* #F8FAFC very light grey for main text */

  /* Semantic colors optimized for dark backgrounds */
  --color-success: rgba(34, 197, 94, 1); /* #22C55E green for success states */
  --color-success-content: rgba(255, 255, 255, 1);
  --color-warning: rgba(251, 191, 36, 1); /* #FBBF24 yellow for warnings */
  --color-warning-content: rgba(0, 0, 0, 1);
  --color-error: rgba(239, 68, 68, 1); /* #EF4444 red for errors */
  --color-error-content: rgba(255, 255, 255, 1);
  --color-info: rgba(59, 130, 246, 1); /* #3B82F6 blue for info */
  --color-info-content: rgba(255, 255, 255, 1);

  /* Border radius for mobile-friendly touch targets */
  --radius-box: 0.5rem; /* 8px rounded corners */
  --radius-field: 0.5rem;
  --radius-selector: 0.5rem;

  /* Border for subtle separations */
  --border: 1px;
}

/* Mobile-specific optimizations */
.mobile-container {
  max-width: 402px;
  margin: 0 auto;
  min-height: 100vh;
  background-color: var(--color-base-200);
}

/* Touch-friendly buttons and interactive elements */
.touch-target {
  min-height: 48px;
  min-width: 48px;
}

/* Secondary text color for metadata */
.text-secondary-gray {
  color: rgba(156, 163, 175, 1); /* #9CA3AF lighter grey for secondary text */
}

/* Safe area padding for mobile devices */
.safe-area-top {
  padding-top: env(safe-area-inset-top);
}

.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

/* Custom scrollbar for dark theme */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: var(--color-base-300);
}

::-webkit-scrollbar-thumb {
  background: var(--color-base-content);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-primary);
}

/* Ensure proper contrast for interactive elements */
.btn, .input, .select, .textarea {
  border-color: var(--color-base-300);
}

.btn:hover, .input:focus, .select:focus, .textarea:focus {
  border-color: var(--color-primary);
}

/* Card elevation for dark theme */
.card {
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
}

.card:hover {
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
}
</style> <style>
/* 当前位置指示器呼吸动画 */
.current-location-indicator {
  z-index: 10;
}

.pulse-animation {
  animation: breathe 2s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { 
    transform: scale(1);
    opacity: 1;
  }
  50% { 
    transform: scale(1.2);
    opacity: 0.8;
  }
}

/* 景点标记交互效果 */
.place-marker {
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 5;
}

.place-marker:hover {
  transform: scale(1.3);
  z-index: 15;
}

.place-marker.visited {
  animation: visitedGlow 3s ease-in-out infinite;
}

@keyframes visitedGlow {
  0%, 100% { 
    box-shadow: 0 0 8px rgba(34, 197, 94, 0.5);
  }
  50% { 
    box-shadow: 0 0 16px rgba(34, 197, 94, 0.8);
  }
}

/* 已完成路径动画 */
.completed-path {
  stroke-dasharray: 1000;
  stroke-dashoffset: 1000;
  animation: drawPath 3s ease-in-out forwards;
}

@keyframes drawPath {
  to {
    stroke-dashoffset: 0;
  }
}

/* 抽卡按钮特效 */
.gacha-trigger-btn {
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
}

.gacha-trigger-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
}

.gacha-trigger-btn:active {
  transform: translateY(0);
  animation: buttonPulse 0.3s ease;
}

@keyframes buttonPulse {
  0% { transform: scale(1); }
  50% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

/* 景点信息预览卡片动画 */
.place-info-preview {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  transform: translateY(100%);
  opacity: 0;
}

.place-info-preview.show {
  transform: translateY(0);
  opacity: 1;
}

/* 地图缩放过渡 */
#citywalkRouteMap {
  transition: transform 0.3s ease;
}

.map-zoomed {
  transform: scale(1.2);
}

/* 指南图标脉动效果 */
.guide-icon-pulse {
  animation: guidePulse 4s ease-in-out infinite;
}

@keyframes guidePulse {
  0%, 100% { 
    opacity: 1;
    transform: scale(1);
  }
  50% { 
    opacity: 0.7;
    transform: scale(1.05);
  }
}

/* 卡片悬浮效果增强 */
.card:hover {
  transform: translateY(-2px);
  transition: all 0.3s ease;
}

/* 触摸反馈 */
.touch-feedback:active {
  transform: scale(0.98);
  transition: transform 0.1s ease;
}

/* 数据概览网格优化 */
.overview-stat {
  transition: all 0.2s ease;
}

.overview-stat:hover {
  transform: translateY(-1px);
}

/* 响应式隐藏优化 */
@media (max-width: 402px) {
  .place-info-preview {
    left: 8px;
    right: 8px;
  }
  
  .card-body {
    padding: 12px;
  }
}

/* 安全区域适配 */
.safe-area-content {
  padding-bottom: calc(env(safe-area-inset-bottom) + 80px);
}

/* 景点标记标签 */
.place-marker::after {
  content: attr(data-place-name);
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--color-base-100);
  color: var(--color-base-content);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 10px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.place-marker:hover::after {
  opacity: 1;
}
</style>
  <script src="./assets/static/uxbot/25_6/holder.js"></script></head>
  <body class="bg-base-200">
    <div class="mobile-container overflow-hidden">
      <div data-section-id="common_header" data-section-type="common_header" class="sticky top-0 z-40 bg-base-100 border-b border-base-300 safe-area-top">
  <div class="navbar px-4 py-2 min-h-14">
    <!-- Left side - Back button or Menu button -->
    <div class="navbar-start">
      <button class="btn btn-ghost btn-sm btn-circle touch-target header-back-btn" onclick="handleBackNavigation()" data-type="button">
        <span class="iconify text-base-content" data-icon="heroicons:arrow-left" data-width="20" data-type="icon"></span>
      </button>
      <!-- Hamburger menu for drawer (hidden by default) -->
      <button class="btn btn-ghost btn-sm btn-circle touch-target header-menu-btn hidden" onclick="toggleDrawer()" data-type="button">
        <span class="iconify text-base-content" data-icon="heroicons:bars-3" data-width="20" data-type="icon"></span>
      </button>
    </div>

    <!-- Center - Title or Search -->
    <div class="navbar-center flex-1 mx-4">
      <!-- Default title display -->
      <h1 class="text-lg font-semibold text-base-content header-title text-center" data-type="text">页面标题</h1>
      <!-- Search input (hidden by default) -->
      <div class="form-control w-full max-w-xs header-search hidden">
        <input type="text" placeholder="搜索内容..." class="input input-bordered input-sm w-full bg-base-200" data-type="input">
      </div>
    </div>

    <!-- Right side - Action buttons -->
    <div class="navbar-end">
      <!-- Search toggle button -->
      <button class="btn btn-ghost btn-sm btn-circle touch-target header-search-btn hidden" data-type="button">
        <span class="iconify text-base-content" data-icon="heroicons:magnifying-glass" data-width="20" data-type="icon"></span>
      </button>
      
      <!-- Add content button -->
      <button class="btn btn-ghost btn-sm btn-circle touch-target header-add-btn hidden" onclick="navigateTo(&#39;content_upload&#39;)" data-type="button">
        <span class="iconify text-base-content" data-icon="heroicons:plus" data-width="20" data-type="icon"></span>
      </button>
      
      <!-- More options menu -->
      <div class="dropdown dropdown-end header-more-menu hidden">
        <button tabindex="0" class="btn btn-ghost btn-sm btn-circle touch-target" data-type="button">
          <span class="iconify text-base-content" data-icon="heroicons:ellipsis-vertical" data-width="20" data-type="icon"></span>
        </button>
        <ul tabindex="0" class="dropdown-content z-50 menu p-2 shadow bg-base-100 rounded-box w-52 mt-2 border border-base-300" data-type="container">
          <li><a onclick="showToast(&#39;分享功能开发中&#39;)" data-type="text">分享</a></li>
          <li><a onclick="showToast(&#39;举报功能开发中&#39;)" data-type="text">举报</a></li>
          <li><a onclick="navigateTo(&#39;support_feedback&#39;)" data-type="text">帮助与反馈</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

<style>
[data-section-id="common_header"] .navbar {
  height: 56px;
}

[data-section-id="common_header"] .header-back-btn:hover,
[data-section-id="common_header"] .header-menu-btn:hover {
  background-color: var(--color-base-200);
  transition: background-color 0.2s ease;
}

[data-section-id="common_header"] .header-title {
  text-align: center;
  line-height: 1.2;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

[data-section-id="common_header"] .header-search input:focus {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
  background-color: var(--color-base-100);
}

[data-section-id="common_header"] .btn-circle:hover {
  transform: scale(1.05);
  transition: transform 0.1s ease;
}

[data-section-id="common_header"] .btn-circle:active {
  transform: scale(0.95);
}

[data-section-id="common_header"] .dropdown-content {
  background-color: var(--color-base-100);
  border: 1px solid var(--color-base-300);
}

[data-section-id="common_header"] .dropdown-content a:hover {
  background-color: var(--color-base-200);
}
</style>

<script>
(function() {
  // Header configuration function
  window.configureHeader = function(options = {}) {
    const header = document.querySelector(&#39;[data-section-id="common_header"]&#39;);
    if (!header) return;

    const {
      title = &#39;页面标题&#39;,
      showBackButton = true,
      showMenuButton = false,
      showSearchButton = false,
      showSearchInput = false,
      showAddButton = false,
      showMoreMenu = false,
      onSearch = null,
      onAdd = null
    } = options;

    // Update title
    const titleElement = header.querySelector(&#39;.header-title&#39;);
    titleElement.textContent = title;

    // Toggle back button
    const backBtn = header.querySelector(&#39;.header-back-btn&#39;);
    const menuBtn = header.querySelector(&#39;.header-menu-btn&#39;);
    backBtn.style.display = showBackButton ? &#39;flex&#39; : &#39;none&#39;;
    menuBtn.style.display = showMenuButton ? &#39;flex&#39; : &#39;none&#39;;

    // Toggle search elements
    const searchBtn = header.querySelector(&#39;.header-search-btn&#39;);
    const searchInput = header.querySelector(&#39;.header-search&#39;);
    searchBtn.classList.toggle(&#39;hidden&#39;, !showSearchButton);
    searchInput.classList.toggle(&#39;hidden&#39;, !showSearchInput);
    titleElement.classList.toggle(&#39;hidden&#39;, showSearchInput);

    // Toggle add button
    const addBtn = header.querySelector(&#39;.header-add-btn&#39;);
    addBtn.classList.toggle(&#39;hidden&#39;, !showAddButton);

    // Toggle more menu
    const moreMenu = header.querySelector(&#39;.header-more-menu&#39;);
    moreMenu.classList.toggle(&#39;hidden&#39;, !showMoreMenu);

    // Handle search toggle
    if (showSearchButton &amp;&amp; !showSearchInput) {
      searchBtn.onclick = function() {
        searchInput.classList.remove(&#39;hidden&#39;);
        titleElement.classList.add(&#39;hidden&#39;);
        searchBtn.classList.add(&#39;hidden&#39;);
        const input = searchInput.querySelector(&#39;input&#39;);
        input.focus();
      };
    }

    // Handle search input
    if (showSearchInput &amp;&amp; onSearch) {
      const input = searchInput.querySelector(&#39;input&#39;);
      input.addEventListener(&#39;input&#39;, function(e) {
        onSearch(e.target.value);
      });
    }

    // Handle add button
    if (showAddButton &amp;&amp; onAdd) {
      addBtn.onclick = onAdd;
    }
  };

  // Drawer toggle function
  window.toggleDrawer = function() {
    const drawer = document.querySelector(&#39;[data-section-id="common_drawer"]&#39;);
    if (drawer) {
      const drawerToggle = drawer.querySelector(&#39;.drawer-toggle&#39;);
      if (drawerToggle) {
        drawerToggle.checked = !drawerToggle.checked;
      }
    }
  };

  // Default header configuration
  document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
    configureHeader();
  });
})();
</script>
      <main class="pb-20 px-4">
        <!-- Citywalk数据概览 -->
        <div id="citywalkOverview" class="card bg-base-100/80 backdrop-blur-sm mb-4">
          <div class="card-body p-4">
            <div class="flex items-center justify-between mb-3">
              <h2 data-type="text" id="irpul" class="text-lg font-bold text-base-content irpul spark-custom-irpul">
                淡水路Citywalk
              </h2>
              <div data-type="text" class="badge badge-primary badge-sm">
                进行中
              </div>
            </div>
            <div class="grid grid-cols-3 gap-4 text-center">
              <div class="flex flex-col items-center">
                <span class="iconify text-primary mb-1" data-icon="heroicons:map" data-width="20" data-type="icon"></span><span data-type="text" class="text-xs text-secondary-gray">总长度</span><span data-type="text" class="text-sm font-semibold text-base-content">5km</span>
              </div>
              <div class="flex flex-col items-center">
                <span class="iconify text-accent mb-1" data-icon="heroicons:map-pin" data-width="20" data-type="icon"></span><span data-type="text" class="text-xs text-secondary-gray">景点</span><span data-type="text" class="text-sm font-semibold text-base-content">12个</span>
              </div>
              <div class="flex flex-col items-center">
                <span class="iconify text-info mb-1" data-icon="heroicons:clock" data-width="20" data-type="icon"></span><span data-type="text" class="text-xs text-secondary-gray">预计</span><span data-type="text" class="text-sm font-semibold text-base-content">2小时</span>
              </div>
            </div>
          </div>
        </div>
        <!-- Citywalk路线图 -->
        <div id="citywalkRouteMap" class="card bg-base-100 mb-4 overflow-hidden">
          <div class="card-body p-0">
            <div class="relative h-80 bg-gradient-to-br from-base-200 to-base-300 holderjs" data-background-src="?placehold.co/400x320.png?text=City+Map+Background">
              <!-- 路线路径 --><svg viewBox="0 0 400 320" preserveAspectRatio="xMidYMid meet" id="i9g4i" class="absolute inset-0 w-full h-full i9g4i spark-custom-i9g4i">
                <path d="M 50 280 Q 120 240 200 200 Q 280 160 350 120" stroke="var(--color-primary)" stroke-width="4" fill="none" stroke-dasharray="8,4" opacity="0.8"></path>
                <path d="M 50 280 Q 120 240 200 200" stroke="var(--color-success)" stroke-width="6" fill="none" class="completed-path"></path></svg><!-- 景点标记 -->
              <div id="ivoog" class="absolute inset-0 ivoog spark-custom-ivoog">
                <!-- 已访问景点 -->
                <div data-place-id="1" data-place-name="断桥残雪" data-place-type="历史景点" data-distance="0km" id="ijagw" class="absolute w-4 h-4 bg-success rounded-full border-2 border-white shadow-lg place-marker visited" style="left: 50px; top: 280px;">
                  <div class="w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></div>
                </div>
                <div data-place-id="2" data-place-name="白堤" data-place-type="风景区" data-distance="1.2km" id="io5qk" class="absolute w-4 h-4 bg-success rounded-full border-2 border-white shadow-lg place-marker visited" style="left: 120px; top: 240px;">
                  <div class="w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></div>
                </div>
                <!-- 当前位置 -->
                <div id="inmj6" class="absolute w-6 h-6 current-location-indicator" style="left: 194px; top: 194px;">
                  <div class="w-6 h-6 bg-primary rounded-full border-3 border-white shadow-lg pulse-animation"></div>
                  <div class="absolute inset-0 bg-primary/30 rounded-full animate-ping"></div>
                </div>
                <!-- 未访问景点 -->
                <div data-place-id="4" data-place-name="苏堤春晓" data-place-type="风景区" data-distance="2.8km" id="itlkpy" class="absolute w-4 h-4 bg-base-300 rounded-full border-2 border-white shadow-lg place-marker unvisited" style="left: 280px; top: 160px;">
                  <div class="w-2 h-2 bg-base-content/50 rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></div>
                </div>
                <div data-place-id="5" data-place-name="雷峰塔" data-place-type="历史建筑" data-distance="4.5km" id="iy7dnd" class="absolute w-4 h-4 bg-base-300 rounded-full border-2 border-white shadow-lg place-marker unvisited" style="left: 350px; top: 120px;">
                  <div class="w-2 h-2 bg-base-content/50 rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"></div>
                </div>
              </div>
              <!-- 地图控制按钮 -->
              <div class="absolute top-4 right-4 flex flex-col gap-2">
                <button data-type="button" class="btn btn-sm btn-circle bg-base-100/80 backdrop-blur-sm border-base-300" onclick="zoomIn()">
                  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="16" height="16" viewBox="0 0 24 24" data-original="&amp;lt;span class=&amp;quot;iconify&amp;quot; data-icon=&amp;quot;heroicons:plus&amp;quot; data-width=&amp;quot;16&amp;quot; data-type=&amp;quot;icon&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;" class="iconify">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 4.5v15m7.5-7.5h-15"></path>
                  </svg></button><button data-type="button" class="btn btn-sm btn-circle bg-base-100/80 backdrop-blur-sm border-base-300" onclick="zoomOut()">
                  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" width="16" height="16" viewBox="0 0 24 24" data-original="&amp;lt;span class=&amp;quot;iconify&amp;quot; data-icon=&amp;quot;heroicons:minus&amp;quot; data-width=&amp;quot;16&amp;quot; data-type=&amp;quot;icon&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;" class="iconify">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 12h14"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- 景点信息预览卡片 (隐藏状态) -->
        <div id="placeInfoPreview" class="fixed inset-x-4 bottom-24 z-50 place-info-preview hidden">
          <div class="card bg-base-100 shadow-xl border border-base-300">
            <div class="card-body p-4">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <h3 data-type="text" class="font-bold text-base mb-1 preview-place-name">
                    景点名称
                  </h3>
                  <div class="flex items-center gap-2 mb-2">
                    <span data-type="text" class="badge badge-outline badge-sm preview-place-type">类型</span><span data-type="text" class="text-xs text-secondary-gray preview-place-distance">距离</span>
                  </div>
                  <p data-type="text" class="text-sm text-base-content/80 mb-3">
                    这里是景点的简短描述信息...
                  </p>
                  <button data-type="button" class="btn btn-primary btn-sm" onclick="viewPlaceDetail()">
                    查看详情
                  </button>
                </div>
                <div class="flex-shrink-0 ml-4">
                  <img alt="景点图片" class="w-16 h-16 object-cover rounded-lg preview-place-image" data-type="image" data-src="placehold.co/80x80.png?text=Place+Image">
                </div>
              </div>
              <button data-type="button" class="btn btn-sm btn-circle btn-ghost absolute top-2 right-2" onclick="closePlacePreview()">
                <span class="iconify" data-icon="heroicons:x-mark" data-width="16" data-type="icon"></span>
              </button>
            </div>
          </div>
        </div>
        <!-- Citywalk动作按钮 -->
        <div id="citywalkActionButtons" class="flex flex-col gap-3">
          <button data-type="button" class="btn btn-primary btn-lg w-full gacha-trigger-btn" onclick="triggerGacha()">
            <span class="iconify mr-2" data-icon="heroicons:gift" data-width="24" data-type="icon"></span><span data-type="text" id="i1b0fi" class="i1b0fi spark-custom-i1b0fi">模拟触发卡片</span>
            <div data-type="text" class="badge badge-accent badge-sm ml-2">
              可用
            </div></button><button data-type="button" class="btn btn-ghost btn-lg w-full" onclick="navigateTo(&#39;citywalk_info_guide&#39;)">
            <span class="iconify mr-2" data-icon="heroicons:information-circle" data-width="24" data-type="icon"></span><span data-type="text">查看更多指南</span>
          </button>
        </div>
      </main>
      <div data-section-id="common_bottom_dock" data-section-type="common_section" class="fixed bottom-0 left-0 right-0 z-40 bg-base-100 border-t border-base-300 safe-area-bottom">
  <div class="dock bg-base-100 py-2 px-4 justify-center">
    <!-- 主页 -->
    <button class="dock-item dock-item-active flex-col items-center justify-center touch-target" data-tab-id="citywalk_main" onclick="navigateTo(&#39;citywalk_main&#39;)" data-type="button">
      <span class="iconify text-xl mb-1" data-icon="heroicons:map" data-width="24" data-type="icon"></span>
      <span class="dock-item-label text-xs" data-type="text">路线</span>
    </button>
    
    <!-- 上传内容 -->
    <button class="dock-item flex-col items-center justify-center touch-target" data-tab-id="content_upload" onclick="navigateTo(&#39;content_upload&#39;)" data-type="button">
      <span class="iconify text-xl mb-1" data-icon="heroicons:plus-circle" data-width="24" data-type="icon"></span>
      <span class="dock-item-label text-xs" data-type="text">上传</span>
    </button>
    
    <!-- 我的卡册 -->
    <button class="dock-item flex-col items-center justify-center touch-target" data-tab-id="my_cards" onclick="navigateTo(&#39;my_cards&#39;)" data-type="button">
      <span class="iconify text-xl mb-1" data-icon="heroicons:squares-2x2" data-width="24" data-type="icon"></span>
      <span class="dock-item-label text-xs" data-type="text">卡册</span>
    </button>
    
    <!-- 个人中心 -->
    <button class="dock-item flex-col items-center justify-center touch-target" data-tab-id="user_profile" onclick="navigateTo(&#39;user_profile&#39;)" data-type="button">
      <span class="iconify text-xl mb-1" data-icon="heroicons:user" data-width="24" data-type="icon"></span>
      <span class="dock-item-label text-xs" data-type="text">我的</span>
    </button>
  </div>
</div>

<style>
[data-section-id="common_bottom_dock"] .dock {
  height: 56px;
  display: flex;
  justify-content: space-around;
  align-items: center;
  max-width: 402px;
  margin: 0 auto;
}

[data-section-id="common_bottom_dock"] .dock-item {
  background: transparent;
  border: none;
  padding: 4px 8px;
  border-radius: 8px;
  min-width: 60px;
  color: var(--color-base-content);
  opacity: 0.6;
  transition: all 0.2s ease;
}

[data-section-id="common_bottom_dock"] .dock-item:hover {
  background-color: var(--color-base-200);
  opacity: 0.8;
}

[data-section-id="common_bottom_dock"] .dock-item-active {
  color: var(--color-primary) !important;
  opacity: 1 !important;
}

[data-section-id="common_bottom_dock"] .dock-item-active .iconify {
  color: var(--color-primary);
}

[data-section-id="common_bottom_dock"] .dock-item-label {
  font-size: 12px;
  line-height: 1;
  margin-top: 2px;
}

[data-section-id="common_bottom_dock"] .dock-item:active {
  transform: scale(0.95);
  transition: transform 0.1s ease;
}

/* Add bottom padding to body to prevent content from being hidden behind dock */
body {
  padding-bottom: 72px; /* 56px dock height + 16px safe area */
}
</style>

<script>
(function() {
  // Function to update active tab in bottom dock
  window.updateBottomDockActive = function(activeTabId) {
    const dockItems = document.querySelectorAll(&#39;[data-section-id="common_bottom_dock"] .dock-item&#39;);
    dockItems.forEach(item => {
      if (item.dataset.tabId === activeTabId) {
        item.classList.add(&#39;dock-item-active&#39;);
      } else {
        item.classList.remove(&#39;dock-item-active&#39;);
      }
    });
  };

  // Add haptic feedback and visual effects on touch
  document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
    const dockItems = document.querySelectorAll(&#39;[data-section-id="common_bottom_dock"] .dock-item&#39;);
    
    dockItems.forEach(item => {
      item.addEventListener(&#39;touchstart&#39;, function() {
        this.style.transform = &#39;scale(0.95)&#39;;
        // Trigger haptic feedback if available
        if (window.triggerHapticFeedback) {
          window.triggerHapticFeedback(&#39;light&#39;);
        }
      });
      
      item.addEventListener(&#39;touchend&#39;, function() {
        setTimeout(() => {
          this.style.transform = &#39;scale(1)&#39;;
        }, 100);
      });
      
      item.addEventListener(&#39;click&#39;, function() {
        // Add visual feedback for tap
        this.style.backgroundColor = &#39;var(--color-primary)&#39;;
        this.style.color = &#39;var(--color-primary-content)&#39;;
        
        setTimeout(() => {
          this.style.backgroundColor = &#39;&#39;;
          this.style.color = &#39;&#39;;
        }, 150);
      });
    });
  });
})();
</script>
    </div>
    <script>
/* JavaScript code for common usage, should be wrapped in a closure */
(function() {
  // Global app state
  window.APP_GLOBALS = window.APP_GLOBALS || {};

  // Navigation function for page transitions
  window.navigateTo = function(targetPageId) {
    // Trigger navigation to another page using the provided snippet
    const isInIframe = window.self !== window.top;
    const targetFileName = `${targetPageId}.html`;
    
    if (isInIframe) {
      window.parent.postMessage({
        type: &#39;iframeNavigation&#39;,
        targetPageId: targetPageId
      }, &#39;*&#39;);
    } else {
      window.location.href = targetFileName;
    }
  };

  // Utility function to handle back navigation
  window.handleBackNavigation = function() {
    if (window.history.length > 1) {
      window.history.back();
    } else {
      navigateTo(&#39;citywalk_main&#39;);
    }
  };

  // Function to show toast notifications
  window.showToast = function(message, type = &#39;info&#39;) {
    const toast = document.createElement(&#39;div&#39;);
    toast.className = `toast toast-bottom toast-center z-50`;
    toast.innerHTML = `<div class="alert alert-${type}"><span>${message}</span></div>`;
    document.body.appendChild(toast);
    
    // Auto remove after 3 seconds
    setTimeout(() => {
      if (toast.parentNode) {
        toast.parentNode.removeChild(toast);
      }
    }, 3000);
  };

  // Smooth scroll to top function
  window.scrollToTop = function() {
    window.scrollTo({
      top: 0,
      behavior: &#39;smooth&#39;
    });
  };

  // Function to update bottom dock active state
  window.updateBottomDockActive = function(activeTabId) {
    const dockItems = document.querySelectorAll(&#39;[data-section-id="common_bottom_dock"] .dock-item&#39;);
    dockItems.forEach(item => {
      if (item.dataset.tabId === activeTabId) {
        item.classList.add(&#39;dock-item-active&#39;);
      } else {
        item.classList.remove(&#39;dock-item-active&#39;);
      }
    });
  };

  // Haptic feedback for mobile interactions
  window.triggerHapticFeedback = function(intensity = &#39;medium&#39;) {
    if (navigator.vibrate) {
      const patterns = {
        light: [10],
        medium: [25],
        heavy: [50]
      };
      navigator.vibrate(patterns[intensity] || patterns.medium);
    }
  };

  // Location service helpers
  window.APP_GLOBALS.locationService = {
    getCurrentPosition: function() {
      return new Promise((resolve, reject) => {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            position => resolve(position),
            error => reject(error),
            { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
          );
        } else {
          reject(new Error(&#39;地理位置服务不可用&#39;));
        }
      });
    }
  };

  // Audio service for gacha effects
  window.APP_GLOBALS.audioService = {
    playGachaSound: function() {
      // Placeholder for gacha sound effect
      if (window.AudioContext || window.webkitAudioContext) {
        try {
          const audioContext = new (window.AudioContext || window.webkitAudioContext)();
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);
          
          oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.3);
          
          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
          
          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.3);
        } catch (e) {
          console.log(&#39;音频播放不可用&#39;);
        }
      }
    }
  };

})();
</script><script>
// 页面初始化
document.addEventListener(&#39;DOMContentLoaded&#39;, function() {
  // 配置头部导航
  configureHeader({
    title: &#39;Citywalk 路线&#39;,
    showBackButton: false,
    showMenuButton: true,
    showAddButton: true,
    showMoreMenu: true,
    onAdd: function() {
      triggerHapticFeedback(&#39;light&#39;);
      navigateTo(&#39;content_upload&#39;);
    }
  });

  // 设置底部导航活跃状态
  updateBottomDockActive(&#39;citywalk_main&#39;);

  // 初始化景点标记点击事件
  initializePlaceMarkers();

  // 初始化地图交互
  initializeMapInteractions();

  // 检查抽卡可用性
  checkGachaAvailability();
});

// 初始化景点标记交互
function initializePlaceMarkers() {
  const placeMarkers = document.querySelectorAll(&#39;.place-marker&#39;);
  
  placeMarkers.forEach(marker => {
    marker.addEventListener(&#39;click&#39;, function() {
      triggerHapticFeedback(&#39;medium&#39;);
      showPlacePreview(this);
    });
    
    // 添加触摸反馈
    marker.addEventListener(&#39;touchstart&#39;, function() {
      this.style.transform = &#39;scale(1.4)&#39;;
    });
    
    marker.addEventListener(&#39;touchend&#39;, function() {
      setTimeout(() => {
        this.style.transform = &#39;scale(1)&#39;;
      }, 100);
    });
  });
}

// 显示景点信息预览
function showPlacePreview(marker) {
  const preview = document.getElementById(&#39;placeInfoPreview&#39;);
  const placeName = marker.dataset.placeName;
  const placeType = marker.dataset.placeType;
  const placeDistance = marker.dataset.placeDistance;
  const placeId = marker.dataset.placeId;
  
  // 更新预览卡片内容
  preview.querySelector(&#39;.preview-place-name&#39;).textContent = placeName;
  preview.querySelector(&#39;.preview-place-type&#39;).textContent = placeType;
  preview.querySelector(&#39;.preview-place-distance&#39;).textContent = `距离 ${placeDistance}`;
  
  // 存储当前选中的景点ID
  preview.dataset.currentPlaceId = placeId;
  
  // 显示预览卡片
  preview.classList.remove(&#39;hidden&#39;);
  setTimeout(() => {
    preview.classList.add(&#39;show&#39;);
  }, 10);
}

// 关闭景点预览
function closePlacePreview() {
  const preview = document.getElementById(&#39;placeInfoPreview&#39;);
  preview.classList.remove(&#39;show&#39;);
  setTimeout(() => {
    preview.classList.add(&#39;hidden&#39;);
  }, 300);
}

// 查看景点详情
function viewPlaceDetail() {
  const preview = document.getElementById(&#39;placeInfoPreview&#39;);
  const placeId = preview.dataset.currentPlaceId;
  
  triggerHapticFeedback(&#39;medium&#39;);
  closePlacePreview();
  
  // 导航到内容抽卡触发页面
  setTimeout(() => {
    navigateTo(&#39;content_gacha_trigger&#39;);
  }, 300);
}

// 初始化地图交互
function initializeMapInteractions() {
  const mapContainer = document.getElementById(&#39;citywalkRouteMap&#39;);
  let isZoomed = false;
  
  // 双击缩放
  mapContainer.addEventListener(&#39;dblclick&#39;, function() {
    isZoomed = !isZoomed;
    this.classList.toggle(&#39;map-zoomed&#39;, isZoomed);
    triggerHapticFeedback(&#39;light&#39;);
  });
  
  // 长按自定义标记功能 (模拟)
  let longPressTimer;
  mapContainer.addEventListener(&#39;touchstart&#39;, function(e) {
    longPressTimer = setTimeout(() => {
      triggerHapticFeedback(&#39;heavy&#39;);
      showToast(&#39;长按功能：添加个人标记点&#39;, &#39;info&#39;);
    }, 800);
  });
  
  mapContainer.addEventListener(&#39;touchend&#39;, function() {
    clearTimeout(longPressTimer);
  });
}

// 地图缩放控制
function zoomIn() {
  const mapContainer = document.getElementById(&#39;citywalkRouteMap&#39;);
  mapContainer.classList.add(&#39;map-zoomed&#39;);
  triggerHapticFeedback(&#39;light&#39;);
  showToast(&#39;地图已放大&#39;, &#39;info&#39;);
}

function zoomOut() {
  const mapContainer = document.getElementById(&#39;citywalkRouteMap&#39;);
  mapContainer.classList.remove(&#39;map-zoomed&#39;);
  triggerHapticFeedback(&#39;light&#39;);
  showToast(&#39;地图已缩小&#39;, &#39;info&#39;);
}

// 检查抽卡可用性
function checkGachaAvailability() {
  // 模拟检查用户位置和抽卡条件
  const gachaBtn = document.querySelector(&#39;.gacha-trigger-btn&#39;);
  const badge = gachaBtn.querySelector(&#39;.badge&#39;);
  
  // 模拟条件检查
  const isNearAttraction = true; // 实际应用中会检查GPS位置
  const hasGachaChance = Math.random() > 0.3; // 模拟抽卡概率
  
  if (isNearAttraction &amp;&amp; hasGachaChance) {
    badge.textContent = &#39;可用&#39;;
    badge.classList.remove(&#39;badge-outline&#39;);
    badge.classList.add(&#39;badge-accent&#39;);
    gachaBtn.disabled = false;
  } else {
    badge.textContent = &#39;暂不可用&#39;;
    badge.classList.remove(&#39;badge-accent&#39;);
    badge.classList.add(&#39;badge-outline&#39;);
    gachaBtn.disabled = true;
  }
}

// 触发抽卡
function triggerGacha() {
  const gachaBtn = document.querySelector(&#39;.gacha-trigger-btn&#39;);
  
  if (gachaBtn.disabled) {
    showToast(&#39;当前位置暂不支持抽卡&#39;, &#39;warning&#39;);
    return;
  }
  
  // 触发按钮动画和音效
  triggerHapticFeedback(&#39;heavy&#39;);
  if (window.APP_GLOBALS &amp;&amp; window.APP_GLOBALS.audioService) {
    window.APP_GLOBALS.audioService.playGachaSound();
  }
  
  // 按钮状态反馈
  gachaBtn.style.transform = &#39;scale(0.95)&#39;;
  setTimeout(() => {
    gachaBtn.style.transform = &#39;scale(1)&#39;;
  }, 150);
  
  showToast(&#39;正在触发抽卡...&#39;, &#39;info&#39;);
  
  // 延迟导航到抽卡页面
  setTimeout(() => {
    navigateTo(&#39;content_gacha_trigger&#39;);
  }, 800);
}

// 汉堡菜单点击处理
function handleMenuClick() {
  triggerHapticFeedback(&#39;light&#39;);
  navigateTo(&#39;user_profile&#39;);
}

// 帮助指南点击处理
function handleGuideClick() {
  triggerHapticFeedback(&#39;light&#39;);
  navigateTo(&#39;citywalk_info_guide&#39;);
}

// 模拟位置更新
function updateCurrentLocation() {
  // 实际应用中会使用GPS定位
  if (window.APP_GLOBALS &amp;&amp; window.APP_GLOBALS.locationService) {
    window.APP_GLOBALS.locationService.getCurrentPosition()
      .then(position => {
        console.log(&#39;位置更新:&#39;, position);
        // 更新地图上的当前位置指示器
        checkGachaAvailability();
      })
      .catch(error => {
        console.log(&#39;位置获取失败:&#39;, error);
      });
  }
}

// 定期检查位置和抽卡条件
setInterval(() => {
  updateCurrentLocation();
}, 30000); // 每30秒检查一次

// 页面可见性变化时的处理
document.addEventListener(&#39;visibilitychange&#39;, function() {
  if (!document.hidden) {
    // 页面重新可见时刷新状态
    checkGachaAvailability();
    updateCurrentLocation();
  }
});
</script>
  

<script>
    setTimeout(() => {
      Holder.run({
        domain: "placehold.co"
      })
    }, 100)
  </script></body></html>'></iframe>
                    </div>
                  </div>

                </body>
                </html>
            